# Skill validation pattern file (Localsetup v2)
# Purpose: Heuristic patterns to flag potentially harmful content in skills. User review required; no auto-block.
# Schema: updated (ISO8601), pattern sets with id, description, scope, keywords or regex.
# Scope: skill_body (SKILL.md text), scripts_and_assets (scripts/assets only), all.
# Descriptions are shown to the user in plain language; do not use heavy jargon.

updated: "2026-02-19T00:00:00Z"
version: "1.0"
sources:
  - "OWASP LLM prompt injection guidance"
  - "pr1m8/prompt-injections taxonomy"
  - "Existing SECURITY_PATTERNS in skill_importer_scan"

prompt_injection:
  - id: ignore_previous_instructions
    description: "If this phrase appears in a skill that gets read by an AI, it could be trying to make the AI forget earlier instructions and follow new ones instead. That can be used to change how the AI behaves in unwanted ways."
    scope: skill_body
    keywords:
      - "ignore previous instructions"
      - "ignore all previous instructions"
      - "disregard previous instructions"
      - "forget everything above"
  - id: reveal_system_prompt
    description: "This may ask the AI to reveal its internal instructions or system text. Someone could use that to learn how to bypass or manipulate the AI."
    scope: skill_body
    keywords:
      - "reveal your system prompt"
      - "show your instructions"
      - "what are your rules"
      - "repeat everything above"
  - id: developer_mode
    description: "Phrases that try to put the AI into a special or unrestricted mode. That can be used to get the AI to do things it would normally refuse."
    scope: skill_body
    keywords:
      - "you are now in developer mode"
      - "developer mode enabled"
      - "jailbreak"
      - "DAN mode"
  - id: override_persona
    description: "Text that tells the AI to act as a different character or ignore its usual limits. In a skill, this could be an attempt to change how the AI responds in unsafe ways."
    scope: skill_body
    keywords:
      - "you are no longer"
      - "from now on you will"
      - "pretend you are"
      - "act as if you"

exfiltration:
  - id: send_env_or_secrets
    description: "Asking to send environment variables, config files, or secrets (e.g. .env) can lead to leaking passwords or keys. If you see this in a skill, check whether it is documenting a risk or actually instructing the AI to exfiltrate data."
    scope: skill_body
    keywords:
      - "send .env"
      - "upload .env"
      - "paste your .env"
      - "share your API key"
      - "output your system prompt"
  - id: tar_and_send
    description: "Instructions to bundle files and send them somewhere can be used to steal data. Review whether the skill is explaining a backup step or asking the AI to exfiltrate content."
    scope: skill_body
    keywords:
      - "tar and send"
      - "zip and upload"
      - "bundle and send"

code_execution:
  - id: paste_to_terminal
    description: "Asking the user or AI to paste something directly into a terminal can run hidden commands. If the skill contains this, it might be trying to get someone to run code without understanding it."
    scope: skill_body
    keywords:
      - "paste this to terminal"
      - "paste the following into your terminal"
      - "run this in your shell"
  - id: curl_pipe_sh
    description: "Downloading from the internet and piping straight into a shell runs whatever that URL serves. In documentation this can be legitimate; in a skill body it may be a way to run code from an external source without clear review."
    scope: skill_body
    regex: "curl\\s+.*\\|\\s*sh|wget\\s+.*\\|\\s*bash"

scripts_and_assets:
  - id: eval_usage
    description: "Code that runs 'eval' on input can execute arbitrary commands. In a skill script this might be intentional, but it can also be a way to run harmful code depending on what is being evaluated."
    scope: scripts_and_assets
    regex: "eval\\s*\\("
  - id: curl_pipe_sh_script
    description: "Downloading a URL and piping it straight into a shell runs whatever that server sends. This can be dangerous if the URL or content is not trusted."
    scope: scripts_and_assets
    regex: "curl\\s+.*\\|\\s*sh\\s|wget\\s+.*\\|\\s*bash"
  - id: base64_decode_pipe_sh
    description: "Decoding base64 and piping to a shell runs hidden commands. Often used to hide what is actually being executed."
    scope: scripts_and_assets
    regex: "base64\\s+-d.*\\|\\s*sh"
  - id: invoke_expression
    description: "Invoke-Expression (PowerShell) runs a string as code. If the string comes from somewhere else, it can run unexpected or harmful commands."
    scope: scripts_and_assets
    keywords:
      - "Invoke-Expression"
  - id: dot_invoke
    description: "Calling .Invoke() on script blocks or strings can execute dynamic code. Similar to eval; review what is being invoked."
    scope: scripts_and_assets
    regex: "\\.Invoke\\("
  - id: etc_shadow
    description: "Access to /etc/shadow usually means reading or changing system passwords. Legitimate scripts rarely need this; flag for review."
    scope: scripts_and_assets
    keywords:
      - "/etc/shadow"
  - id: etc_passwd
    description: "Reading or writing /etc/passwd can affect user accounts. In a skill script this is unusual and worth checking."
    scope: scripts_and_assets
    regex: "/etc/passwd\\s"
  - id: nopasswd
    description: "NOPASSWD in sudoers allows running commands as root without a password. If a skill script references this, it may be changing system security settings."
    scope: scripts_and_assets
    keywords:
      - "NOPASSWD"

crypto_mining:
  - id: stratum_miner
    description: "Stratum is often used by cryptocurrency mining pools. A skill that mentions it might be trying to use the machine for mining without clear consent."
    scope: all
    keywords:
      - "stratum"
      - "xmrig"
      - "miner"
      - "mining pool"
